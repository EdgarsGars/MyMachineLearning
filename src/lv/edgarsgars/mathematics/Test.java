/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package lv.edgarsgars.mathematics;

import lv.edgarsgars.classifiers.knn.CnnClassifier;
import lv.edgarsgars.classifiers.knn.KnnClassifier;
import lv.edgarsgars.utils.MatrixUtils;

/**
 *
 * @author Edgar_000
 */
public class Test {

    public static void main(String[] args) {
        //Train
        int sampleSize = 5000;
        int dim = 4;
        //Matrix x = MatrixUtils.getRandom(sampleSize, dim, -100, 100);
        // Matrix y = new Matrix(sampleSize, 1);
        Matrix x = new Matrix("[-0.146514957151338 -0.101286080277012 -0.296409532903045 1.58351826505558;-0.314292930905450 -0.555343198515540 -0.458529165794008 1.35714848112132;-1.20468141138418 -1.19953471719675 -1.63233309789125 -0.00787262827008460;-0.673330551844954 -0.949135694493191 -0.755501549380824 0.0466307245844062;-0.0531543599625431 0.00275467849778610 -0.0781446177615583 0.387041408059915;1.36322853426281 0.656126091587464 1.26570837444699 1.06384450745602;-1.37934088455562 -1.29787788614174 -1.62868583272101 0.0856588653544494;-0.134897278179812 -0.233791029462230 -0.235842193505496 0.754325735289957;0.0993680923256805 0.0413064159683451 -0.157408954719258 0.309955833106739;-1.64966338000159 -1.52715592657063 -1.78188463003936 -0.209308826180316;-0.722957573350401 -0.718274043558515 -0.981213815070735 0.549296430440888;-1.51444190018857 -1.40652194640287 -1.68764369024354 -0.130993496710105;-1.10771756198680 -1.07910221302104 -1.09760803708094 -0.128887682770723;-0.376427867098554 -0.731687242426781 -0.502090700198880 -0.145746085586472;-0.0911786885740399 -0.155548611938891 -0.125030496781206 1.04402923247307;-0.129317161511546 -0.00943497800798589 -0.223229101337905 0.361858112777821;-1.15496581898972 -0.989026269203279 -1.36150246702775 0.542930977704735;-0.912544145981772 -0.821132805560751 -0.992303303543489 0.313525445105543;-0.0297319036407603 -0.328798218276387 0.00225033787194777 1.65567183338509;-1.63702841095072 -1.56371213772968 -1.55835028797892 0.655778956408000;0.367098975516309 -0.0801013103907492 0.788795287013241 -0.734315566502229;-0.0997772946781619 -0.184660209953004 0.316565722236744 -0.257112397615790;-1.06559186537685 -1.27089550245522 -1.35449411748444 -0.574428563427309;-1.44320452713242 -1.43267480546375 -1.63166573579827 -0.702418308570929;-0.491122039451710 -0.500200671386358 -0.367949601484690 0.924040307161595;-1.60545661771250 -1.57236646029487 -1.55183012615066 1.66259101570925;-1.70095462552438 -1.55427050558960 -1.66968552038679 -0.739165817803955;-0.603328208365879 -0.618526914311623 -0.607999382929304 1.09081857453198;-1.28628151952757 -1.36471923312203 -1.57125256889103 -0.132556956752286;-0.233586393829780 -0.451624103726002 -0.0120904971568619 -0.100614631515246;-1.22901106353595 -1.23035935915013 -1.44336803393706 -0.650207428062269;-0.564715432672321 -0.673596797014683 -0.606484088729913 1.30727826958830;-0.418768213127605 -0.430478772359001 -0.350263655406734 1.50581228758583;-0.160510167889353 -0.355612206935690 -0.203212626924342 0.370284380750255;-1.07861112907810 -1.12779836557631 -1.49017171726780 0.168857701514684;-0.950317380505969 -1.06085962532332 -1.08182275360103 1.52899804553751;0.618724078635410 0.135203518860346 0.722438254138661 0.738689312891045;0.872686387479443 0.883120128176187 1.06041921348913 0.109646783222688;-1.85983380634571 -1.75272282255147 -1.84444556096560 -0.821517382172841;-1.47370413830115 -1.43108735321710 -1.40562208336614 0.0575743248064341;-0.787550162934473 -0.981118860953724 -0.759055798122781 0.885161953602635;0.192515500365739 -0.196774757933131 0.312403952575427 0.671972478281639;-1.36645449581628 -1.29055016518869 -1.57829535278888 0.711382579936221;-1.13338154643425 -1.23672723321450 -1.53211607342821 0.261422071983838;0.166144703673314 0.112803705641824 0.186381826314273 2.34136532226423;-0.557791069939774 -0.685376252501007 -0.741853013864502 0.804820543920783;0.787517173008177 0.234025263626235 0.615383034094543 1.22030999406561;0.815550964415641 0.240512450791572 0.485220488409785 1.21814430162686;0.124547548220500 -0.258892300928622 -0.0487390795103099 1.08500080405753;-0.397943112207866 -0.658466096023741 -0.668184697220170 0.609141865853161;0.389184912542112 -0.161331389309491 0.249576125632867 2.52748191969797;-1.62801083687003 -1.61848627794931 -1.69030489364352 -0.205057921611916;-1.75951992117862 -1.63337686554733 -1.70521786577412 -0.612274710827179;-0.318466042230996 -0.362542142070323 -0.536384426047821 1.71339256835313;-0.659451939562504 -0.941018418081992 -0.537526786122342 0.564492529665515;-1.31971530217905 -1.32525256567580 -1.23605159007090 -0.152149004645442;0.201789181004565 -0.163519526043396 0.300927232445602 1.52191145964567;-1.27316531133660 -1.24776676181199 -1.37806661173886 1.39296059038916;-1.69196270336596 -1.63402288576668 -1.60640987396781 -0.388948661578654;-0.609585519505679 -0.589420666655812 -0.495249329626809 1.28416831054869;-1.27470678700986 -1.15124914812850 -1.40213292038984 0.206185235294090;-1.03607305126138 -0.884948882950285 -1.11138888616298 -0.0390855459593625;0.181975419044731 0.179620651615459 0.265024267522887 1.42988952241341;0.109757308274268 0.247604803844078 0.352642106954246 0.810153408464959;-1.37034320989332 -1.36551654176358 -1.68098636746496 -0.0965007557451733;-0.736958920010679 -0.809086716656929 -0.847465382593741 0.0857334399693375;-1.58088869009087 -1.44197644263363 -1.65684281939726 0.0107719777278981;-0.387298164911636 -0.287738118211087 -0.421681313514521 1.19734343040716;-1.49570388204334 -1.34429279655034 -1.54328785246006 -0.177867078233294;0.214680898751297 0.331891203992696 0.194013731065539 0.729270181396381;-1.12687798270064 -0.899662697411688 -1.12303320465988 0.263943833809432;-0.0389374992044462 0.0311265837273380 -0.0707694453189337 0.931253690808487;0.511419418820380 0.377714094473678 0.602156643916672 0.515950403387315;0.0149350797155076 -0.158809877852983 -0.0997672544644746 0.928753505704715;0.368254724025287 0.363617214567551 0.296367736623751 -0.531010811321242;-1.08936320101179 -1.11462864447363 -1.28164160340379 -0.336798124928158;-0.655625698982186 -0.713587633203554 -0.690325347788707 -0.00721526585129554;-1.43024474811568 -1.50090620091357 -1.75438599053011 -0.434083652342896;-0.411924223025881 -0.705076251046226 -0.797196698867092 1.06903211383995;0.695056357072099 0.0599444159739364 0.425798147409185 -0.299480057860982;-1.84698674947279 -1.80771417040039 -1.74184657062452 -0.545078446311795;0.183368789373528 -0.218974675703478 0.416331650169636 2.08838822622385;-0.482407070628383 -0.432142090780414 -0.303423936212557 0.818473457692186;-0.585419528244802 -0.709405143515083 -0.675881935453007 1.07898290401943;0.358236225027516 -0.168911350170746 0.249138122025142 0.692201555936217;-0.839279268336421 -1.02299711061716 -1.20788261370708 0.0613004620709706;-1.11685007082752 -1.06491268655596 -1.23516281281978 -0.644038268685061;-0.752321986599987 -0.660922704701045 -0.729937348938215 1.47750489245476;-1.72486278294603 -1.64128840083666 -1.61097944658371 -0.291073527504488;-0.920869198766489 -1.17704732391940 -1.02841360354049 3.64420950376498;-1.60029506564223 -1.44591949374760 -1.50255882531230 -0.315715476258618;-0.829053503174028 -0.827342733078622 -0.452012788721172 0.912542620032967;-1.61475986045146 -1.63512699305073 -1.68501167757142 -0.316013087921990;-0.341846477452029 -0.800302200853848 -0.462637514098696 0.130669008553637;-1.76445242268979 -1.62980691402040 -1.64417338121881 -0.120170344264012;-0.108676995135856 -0.275775960789617 -0.164058119240539 0.861034795047902;-0.554257235999323 -0.646080166609496 -0.607772285728889 1.04432787952997;-0.167780024991961 -0.625557715617881 -0.299851895535651 1.07541822606745;-1.10513569873262 -1.23606068551956 -1.09139388619085 -0.0312595844262136;-0.564809756953608 -0.540420381787626 -0.530769746844712 0.930316472261299;-0.742559701579685 -0.827902753447225 -0.790697566135085 1.15524742414110;-1.13586960102430 -1.12387187469734 -1.17527996610838 0.0657930573443163;0.718016395638304 1.00493574507622 0.679486699444177 -1.15941786929302;0.826776898995897 1.06690668553107 0.817554414012624 -1.18589782825324;0.814512296552633 1.10634330955281 0.747920418124338 -1.32688154352635;0.997492475774156 1.17495393620347 0.817806643766330 -0.963633014289133;0.830799926158710 1.11954684737106 0.782745946822125 -1.42490883572144;0.784843758436264 1.09531379979836 0.786477989241088 -1.05349630115648;0.800875725513272 1.06880412553382 0.639368647840426 -1.29362890914492;0.840080642961204 1.09943048760055 0.875218348876151 -1.27357423381294;0.917188753962319 1.14550961461224 0.735696843405921 -1.31313898300085;0.874426195528261 1.13389463311228 0.766172604727096 -1.23603853345577;0.988615061885398 1.20908121428168 0.831790533439912 -1.17989394721849;0.951277443151093 1.21515914943839 0.873708566427890 -1.20854478369904;0.995231552937326 1.20003468739720 0.973391983184587 -1.15744935044048;1.11182666902098 1.32245386250699 1.06556124267150 -1.21077702615291;0.937536927391119 1.18221972872178 0.899183287044893 -1.11232251628375;0.981040847109606 1.16686709714567 0.849979746133139 -1.26822048903777;1.09952156442107 1.22643573294264 0.961431846748863 -0.277396475225147;0.925654172614373 1.16815171304746 0.985733352115469 -1.31226382290022;0.891621973358278 1.18359270356680 0.889047714483034 -1.20850182689203;1.00613982210312 1.22384679787026 1.09596611076103 -1.12074247153296;0.926056261723558 1.21046127118905 1.02020635867999 -1.47602166069053;0.991093227063897 1.19713422593127 0.872327918168019 -1.11946452527328;0.801528485153046 1.06602416419373 0.847310081466356 -1.22377272301582;0.889585235826286 1.16300433579375 0.823124923915486 -1.02287055364795;1.00324670194783 1.24623107292148 0.957992626104794 -1.37748467373013;0.956668902419732 1.22747920355632 0.798055990834535 -1.21034841805717;0.797444515634538 1.00546597634275 0.679548326714756 -1.19748163065059;1.03349116264160 1.23257637442139 0.924385033449111 -1.17919780405347;1.09662860426569 1.29008778354231 1.03908191457378 -0.879825265117215;0.738336507789862 1.02946091515619 0.728501657185271 -1.36617656216858;1.67169266596439 1.55868420959996 1.15750756174389 -0.0757529270151583;1.27459367587423 1.34936236810250 1.13492567324946 -0.580931813962506;1.17283656561779 1.33619311132645 1.03062126195099 -1.10095844106636;1.27979723472312 1.37374513561690 0.956140245712883 -0.967452390376656;1.24970849526454 1.24788242779683 0.822481264203359 -1.07628747856549;1.03210351272446 1.21392933690189 0.741290682683817 -1.26256509154259;1.48932984200546 1.50995379772150 1.19652242953019 -1.11611979798962;1.19618575133889 1.29191239496236 0.963540861094003 -0.794370654227899;1.12750444452699 1.21297865035683 0.683611984351496 -0.885943382710014;1.47441692380893 1.39218306410029 1.06548474572411 -1.03128587806990;1.73093555359901 1.54668266267972 0.908283658685151 -0.327604021527394;1.48844245459424 1.39048703022815 1.03792703992475 -0.913084519382947;1.35978316415503 1.30330908312208 0.980796505207252 -0.605360637690541;0.937138357681619 1.18478821854414 0.789304010554996 -1.47720991922253;0.973606724609338 1.19355842813348 0.829470780849863 -1.11666393012908;1.04925170682228 1.24546430522573 0.868193521066828 -1.15679769019793;0.794740068492640 1.07643502661305 0.760019095469133 -1.02515879395603;0.972679152064724 1.17031060710974 0.768141111217829 -1.22740565388543;0.825423731798408 1.07354310021216 0.833976296565648 -1.24748928802259;0.860036492740351 1.12686193567123 0.821193994143288 -1.11305890195549;1.01918533531916 1.22561595327070 1.02032745656492 -1.02925059568731;0.775388278055830 1.09418661384177 0.666863179028157 -1.29080134898399;1.09185741731917 1.26350084960851 0.889607335538384 -1.15747578016552;1.29310841367883 1.38382897724477 1.08407579426774 -1.17586679284694;1.17870891248107 1.33106385940729 1.03376599403422 -1.08983854898529;1.17159549014749 1.30293386951183 0.913251883074437 -1.38461092590811;1.58942960141606 1.47237807427214 0.945556039542049 -0.995415054645776;2.49760405407961 1.89255197336767 1.00374245085065 -0.503723690143893;2.18247289064702 1.64545081722629 0.615270058250494 -0.613680136441360;2.84002769519408 2.11929849181852 1.21715247913954 -0.263890668325767;2.62458683731205 1.97133174737330 1.00139483395744 -0.622192153442917;1.77665384478337 1.47888103951426 0.770978961388129 -0.527622383029407;1.90898894387664 1.62842561367733 1.00944962489170 -0.0102242954119798]");
        Matrix y = new Matrix("[1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0]");
        /*  for (int i = 0; i < x.getRowCount(); i++) {

            //double dist = Math.sqrt(Math.pow(x.get(i, 0), 2) + Math.pow(x.get(i, 1), 2));
            double dist = Math.abs(x.get(i, 0) - x.get(i, 1));
            //System.out.println(x.get(i, 0) + ".^2 + " + Math.pow(x.get(i, 1), 2) +" = " + dist);
            if (dist < 30) {
                y.set(1, i, 0);
            } else if (dist >= 30 && dist < 90) {
                y.set(2, i, 0);
            } else {
                y.set(0, i, 0);
            }
        }
        // y.set(Math.abs(x.get(i, 0) - x.get(i, 1)) < 30 ? 1 : 0, i, 0);*/
        System.out.println("samples = " + x);
        System.out.println("samplesC = " + y.toString());
        final KnnClassifier knn = new CnnClassifier(3, x.getCollumCount());
        // final KnnClassifier knn = new KnnClassifier(x.getCollumCount());

        knn.train(x, y);
        Matrix xx = MatrixUtils.loadFromFile("E:/data.txt", "\t");
        Matrix yy = knn.predict(xx, 3);
        System.out.println("x = " + xx);
        System.out.println("c = " + yy);

        /*
        //Cla
        Matrix xx = MatrixUtils.getRandom(700, dim, -100, 100);

        System.out.println("x = " + xx);
        Matrix yy = knn.predict(xx, 3);

        System.out.println("c = " + yy);
         */
    }
}
